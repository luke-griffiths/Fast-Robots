# Motor Control
For this lab, the objective was to wire up the motor drivers and demonstrate open-loop control. The motor driver used for this lab (and for all subsequent labs) 
is the DRV8833 Dual Motor Driver. This driver has an operating voltage of 2.7-10.8V, so when testing on the power supply I ran the motors at 6V. 
Because the RC car's motors require a lot of current, I doubled up the motor drivers and made each motor driver chip power one motor. This allowed the max current to 
be 2.4A instead of 1.2A; however, the higher current means that I needed to be careful about the wire gauge. The jumper wires that were fine to use for the IMU and ToF
sensors can't handle more than ~1A, so I used higher gauge wire for the motor driver output and power(I just recently watched someone learn this lesson and blow a jumper wire,
so I was sure not to make the same mistake). For the signal wires coming from the Artemis, I used normal jumper wires since the current is guaranteed to be low. 

![IMG_6222](https://user-images.githubusercontent.com/71809396/157168254-4570de25-3a12-4178-8536-3954c25624fe.jpg)

I plan on keeping both batteries in the battery compartment of the car, with the Artemis, IMU, and motor drivers where they are in the image above. The ToF sensors will 
be mounted on the front and right sides of the car.

## PWM Duty Cycle
I ran the motors at a 10% duty cycle and a 20% duty cycle. Because the wheels were suspended in the air and had little resistance, they were scarily fast 
so I didn't exceed 20%. 
Here's 10%

![IMG_6198](https://user-images.githubusercontent.com/71809396/157169130-8603d4e6-f147-4a33-afb8-365f788e38b6.jpg)

<iframe width="560" height="315" src="https://youtu.be/1xWd1by1KB8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe> 10% Duty Cycle

and here's 20%

![IMG_6199](https://user-images.githubusercontent.com/71809396/157169181-730d1d58-fb66-4faa-8518-cc415d1a7e8e.jpg)

<iframe width="560" height="315" src="https://youtu.be/R6NFwGVXkhc" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe> 20% Duty Cycle

Interestingly, in the video at 20%, there appears to be temporal aliasing. You can see the spokes of the wheel appear to turn in the opposite direction for the first second or so of the video. According to the camera data, the video is shot with 60 fps. This means that the wheel was rotating at just under 60 times/second. 
This is extremely fast for such a low duty cycle; however, keep in mind that the wheels have nearly no load when they're suspended in the air. According to my calculations from lab 4, the motors didn't even spin that fast during the max speed test, so it's unlikely you'd see aliasing in a video of the car driven on the ground.

Since this lab is hardware heavy, I just ran basic commands to drive the motors. The following code is all that is needed to make the car move in a straight line:

<img width="175" alt="Screen Shot 2022-03-08 at 12 14 03 AM" src="https://user-images.githubusercontent.com/71809396/157170836-84b65fcc-6dfa-4fe6-b55a-327a4b288b5b.png">

The analogWrite function takes two values, the pin number and the effort value between 0 and 255. This means that a value of 0 is 0% effort, a value of 127 is. a 50% duty cycle, etc. 

## Straight line test
I marked out a (somewhat) straight line to test the car's ability to follow a straight line. As you can see in the video, there is some drift toward the left. I couldn't manage to fully eliminate this drift, even when increasing the left motor's output relative to the right one. This issue could be solved with PID later on, but I'd like to see if this is a common issue with the motors being unequal or if there's a short in my wiring that is messing up the power distribution to the two motors. 

<iframe width="560" height="315" src="https://youtu.be/P3CG6HSHHvk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe> Straight line test

## Circles
I decided to demonstrate that the car can turn in circles and remain in the same place, since this is one of the tests I performed in the previous lab. As you can see, the car does stay in the same position while spinning in circles, which means that my motor drivers perform about as well as the car's original motor driver.
The even numbered analog pins (0 and 2) move the car forward, while the odd pins (1 and 3) move it backward. To implement a left turn, PWM signals must be generated by pins 1 and 2. To do a right turn, pins 0 and 3 must be used. 

<iframe width="560" height="315" src="https://youtu.be/f85yQD4egsQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe> circle test

## Lower limit
I found that the lower limit of the motors (the point at which they no longer moved the car) was about 10% duty cycle (25/255) for moving in a straight line; however, when trying to make a left or right turn, the motors couldn't move the car starting at about 14% duty cycle (35/255). 


